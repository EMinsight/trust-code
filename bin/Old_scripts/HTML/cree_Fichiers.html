#!/bin/bash
# Creation d'un fichier .$NOM.html dans l'atelier avec ses caracteristiques :
NOM=`basename $1`
REP=`dirname $1`

# Ecriture du fichier :
echo $ECHO_OPTS "<!--NewPage-->
<html>
<head>
<title>Fichier $NOM</title>
</head>
<body>
<BODY BGCOLOR="#D0D5D9" TEXT="#23238E" LINK="#E47833" ALINK="#007FFF" VLINK="#007FFF">
<a href=$TRUST_ROOT/doc/TRUST.html>TRUST </a> | <a href=$TRUST_ROOT/doc/index.html>Classes</a>
<PRE>
<HR>
<h1>Versions disponibles du fichier $NOM</h1>
<HR>
<FORM METHOD="Recuperer" ACTION="$TRUST_ROOT/form/Recuperer_version.ksh?"><input type="submit" value="Recuperer"> Recopier vers l'atelier une des versions disponibles</FORM>"

echo $ECHO_OPTS "\n" | Voir.sccs $REP/$NOM | $TRUST_Awk -v REP=$REP -v NOM=$NOM '(NR>3) && ($1!="Tapez") {n=split($2,a,"/");com="";for (i=5;i<NF+1;i++) com=com" "$i;print "<HR>\n<h1> "$1" <a href=."NOM"."$1".old>Voir</a></h1>Version du "a[3]"/"a[2]"/"a[1]" creee a "$3" par "$4".\nCommentaires:"com}'
echo $ECHO_OPTS "<HR>
</body>
</html> "

# Creation des fichier html des differentes versions :
liste_num_version=`echo $ECHO_OPTS "\n" | Voir.sccs $REP/$NOM | $TRUST_Awk '(NR>3) && ($1!="Tapez") {print $1}'`
cd $REP/.sccs
for n in $liste_num_version
do
   get -r$n $REP/.sccs/s.$NOM 1>/dev/null
   mv -f $REP/.sccs/$NOM $rep_dev/.$NOM.$n.old
done
