Parameters {
	Title "Analytical solution to check VDF upwind scheme"
	Author "Pierre LEDAC"
	VersionTrio_U 1.8.3_beta
	IncludeData 2
   	Prerequisite "./extract_convergence"
 	TestCase . test0.data
	TestCase . test1.data
	TestCase . test2.data
	Description "Check analytical solution u(x,y)=v(x,y)=exp(x-y) for Navier Stokes equations using upwind scheme:"
	Description "Div(u)=0 	U.grad(U)=-grad(P)"
	Description "Boundary conditions: Dirichlet on left/bottom, Outlet (P=0) on top/right"
}
Chapter {
        Title "Meshes and analytical solution"
        visu {
        	Description ""
        	nb_img_without_newline 3
        	width 5cm
                mesh test0.lata dom
		blackvector test0.lata dom SOLUTION ELEM
        }
        visu {
        	Description ""
        	nb_img_without_newline 3
        	width 5cm
                mesh test1.lata dom
        }
        visu {
        	Description ""
        	nb_img_without_newline 3
        	width 5cm
                mesh test2.lata dom
        }
}
Chapter {
        Title "Mesh convergence on Y velocity"
        Figure {
		Title "Residual"
		width 11cm
                include_description_curves 0
		nb_img_without_newline 2
                labelX "TIME"
                labelY "residu=max|Ri|"
                logX
                logY
                curve {
                        file test0.dt_ev
                        columns ($1) ($4)
                        style linespoints
                }
                curve {
                        file test1.dt_ev
                        columns ($1) ($4)
                        style linespoints
                }
                curve {
                        file test2.dt_ev
                        columns ($1) ($4)
                        style linespoints
                }
	}
        Figure
    	{
		Title "Profile at Y=0"
		width 11cm
        	labelx X
        	labely Velocity
        	Include_Description_Curves 0
       		Curve
        	{
            		segment test0 VX
            		style linespoints
        	}
       		Curve
        	{
            		segment test1 VX
            		style linespoints
        	}
       		Curve
        	{
            		segment test2 VX
            		style linespoints
        	}
	        Curve
	        {
            		legend "Solution"
            		fonction exp(x)
            		style lines
	        }
	}
	Figure
    	{
		Title "Max error order"
		width 11cm
        	labelx Mesh size
        	labely Max error
		rangeX 0.01 1
        	logx
        	logy
        	Include_Description_Curves 0
        	Curve
        	{
            		legend "Code"
            		file conv_glob
            		colonnes (1./sqrt($1)) $2
            		style points
	        }
		Curve
	        {
            		legend "Order 1"
            		fonction x
            		style lines
	        }
	        Curve
	        {
            		legend "Order 2"
            		fonction x*x
            		style lines
	        }
	}
}
Chapter {
        Title "Max error"
        visu {
        	Description ""
        	nb_img_without_newline 3
        	width 5cm
                mesh test0.lata dom
		pseudocolor test0.lata dom ERREUR_VY ELEM
        }
        visu {
        	Description ""
        	nb_img_without_newline 3
        	width 5cm
                mesh test1.lata dom
		pseudocolor test1.lata dom ERREUR_VY ELEM
        }
        visu {
        	Description ""
        	nb_img_without_newline 3
        	width 5cm
                mesh test2.lata dom
		pseudocolor test2.lata dom ERREUR_VY ELEM
        }
}
Chapter {
      	Title "Conclusion"
	Description "\latex_(We notice the \textbf{first order} variation of upwind scheme.\latex_)"
	Description "\latex_(Nevertheless, an oddity appears near the right-bottom corner where Dirichlet switches to Neuman boundary condition.\latex_)"
	Description "\latex_(This oddity, also detected for the VDF quick scheme but not seen for VEF discretization, leads to an higher level of error there.\latex_)
	Description "\latex_(This error level is reduced when the analytical solution is applied as a Dirichlet condition on \textbf{all} the boundaries.\latex_)"
}
Chapter {
	Title "Computer performance"
	tableau_performance {
	}
}
