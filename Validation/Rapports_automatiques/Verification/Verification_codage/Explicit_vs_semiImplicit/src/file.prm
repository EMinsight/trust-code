Parameters {
        Title "Explicit vs semi-implicit time integration schemes: Periodic channel test case"
        Description "This document aims at providing comparisons between explicit and semi-implicit (diffusion implicit) schemes. Three time integration schemes are examined: Rational Range-Kutta (RRK2, second order), Adam-Bashforth (AB2, second order) and Range-Kutta (RK3, third order). A periodic channel test case is investigated. The physical time of the simulation is 1 second (a turbulent transitional zone is well reached but the steady state solution not established). Space-averaged RMS profiles of all velocity components are used for comparisons (NOTE: space and not time RMS)."
        VersionTrio_U "1.8.3"
        Author "Elie Saikali"
        TestCase RRK2 Cas.data /* data file in appendix */
        TestCase RK3 Cas.data
        TestCase AB2 Cas.data
        TestCase RRK2_2 Cas.data
        TestCase RK3_2 Cas.data
        TestCase AB2_2 Cas.data
        TestCase RRK2_impl Cas.data /* data file in appendix */    
        TestCase RK3_impl Cas.data
        TestCase AB2_impl Cas.data
        TestCase RRK2_impl_2 Cas.data    
        TestCase RK3_impl_2 Cas.data
        TestCase AB2_impl_2 Cas.data
}

# Setup and Mesh 
Chapter
{
	title "Numerical setup"
	Description "\latex_( The data file is almost the same in all the calculations (hydraulic problem, VDF discretization with a 2nd order center scheme for the space derivatives). Three parameters only change depending on the considered case: the time scheme, the diffusion\_implicit flag and the fac\_sec. The mesh used is depicted in figure 2.1. In total 12 simulations are performed. For each scheme we consider a pure explicit and a semi-implicit simulation. In each case we consider 2 fac\_sec parameters. Table 2.2 summarizes the facsec values used in the 12 calculations.  \latex_)"

        visu { 
		title "Mesh"
                normal3D -0.708227 0.361609 0.606344
                up3D 0.322195 0.929759 -0.178153
  		operator no_databaseinfo
		operator_to_all no_legend
		cycles -1
                mesh RK3/Cas.lata dom 
        }

    Table {
	Title "Facsec used in all calculations"
	nb_columns 2
	label  facsec | Result
	line {
		legend -
		 values - -
	     }
	line {
		legend RRK2
		 values 1.4 OK		
	     }	     
	line {
		legend RRK2_impl
		 values 1.4 NO		
	     }	     
	line {
		legend AB2
		 values 0.8 NO		
	     }
	line {
		legend AB2_impl
		 values 0.8 NO		
	     }	   
	line {
		legend RK3
		 values 1.8 Ok		
	     }
	line {
		legend RK3_impl
		 values 1.8 NO		
	     }	
	 line {
		legend -
		 values - -
	     }    	     
	line {
		legend RRK2_2
		 values 0.7 Improved		
	     }	     
	line {
		legend RRK2_impl_2
		 values 0.7 OK		
	     }	     
	line {
		legend AB2_2
		 values 0.4 OK		
	     }
	line {
		legend AB2_impl_2
		 values 0.4 OK		
	     }	   
	line {
		legend RK3_2
		 values 0.9 Improved		
	     }
	line {
		legend RK3_impl_2
		 values 0.9 OK		
	     }
	line {
		legend -
		 values - -
	     }	     
	     
	 }
}

Chapter {
	title "RMS ux comparisons"
	Description "\latex_( We consider first the space-avaraged vertical profiles of the uy RMS values obtained with 6 calculations (facsec 0.8 AB2, 1.4 for RRK2 and 1.8 for RK3). We see that the profiles obtained with RRK2 and AB2 disagree with the other profiles obtained by RK3 (figure 3.1). We divide the facsec value by half in all cases. As a result, coherent profiles are reported in all cases (figure 3.2). This result confirms that the stability and the precision of the employed scheme should be carefully analyzed. RRK2 with a high time step blocks the transitional zone and leads to small RMS values. AB2 requires a small time step to predict a precise transitional solution. \latex_)"

	Figure {
		Dimension 2
		Title "Large facsec values : wrong results"
        	LabelX "Y [m]"
        	LabelY "RMS ux"
		grid
		Width 10cm
         	Include_Description_Curves 0
		Curve {
		legend "RRK2, facsec = 1.4" 
                file RRK2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
		Curve {
		legend "RRK2_impl, facsec = 1.4" 
                file RRK2_impl/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
		Curve {
		legend "AB2, facsec = 0.8" 
                file AB2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
		Curve {
		legend "AB2_impl, facsec = 0.8" 
                file AB2_impl/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
		Curve {
		legend "RK3, facsec = 1.8" 
                file RK3/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
		Curve {
		legend "RK3_impl, facsec = 1.8" 
                file RK3_impl/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
	}


	
	Figure {
		Dimension 2
		Title "Smaller facsec values : OK"
        	LabelX "Y [m]"
        	LabelY "RMS ux"
		grid
		Width 10cm
         	Include_Description_Curves 0
		Curve {
		legend "RRK2_2, facsec = 0.7" 
                file RRK2_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
		Curve {
		legend "RRK2_impl_2, facsec = 0.7" 
                file RRK2_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
		Curve {
		legend "AB2_2, facsec = 0.4" 
                file AB2_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
		Curve {
		legend "AB2_impl_2, facsec = 0.4" 
                file AB2_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
		Curve {
		legend "RK3_2, facsec = 0.9" 
                file RK3_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
		Curve {
		legend "RK3_impl_2, facsec = 0.9" 
                file RK3_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
	}
	
	

	Figure {
		Dimension 2
		Description "\latex_( We compare the results obtained by RK3 for both facsecs (see figure 3.3). We see in particular that a lower facsec is required when the diffusion is implicited. This can be justified as follows: when the scheme is explicit, the time step is selected as that of the viscous one (its more dominant than the convective one). As a result, the scheme is able to capture the turbulent transition because the time step is sufficiently small. In the other case, when the diffusion is implicit, the time step is selected from that corresponding to the convective term. As a result, for a facsec of 1.8, the time step is not sufficiently small and the transitional behavior of the flow is not reproduced (see figure 3.4). We report the same behavior with RRK2 (figures 3.5 and 3.6).\latex_)"
		Title "Comparisons for RK3 : facsec 1.8 vs 0.9"
        	LabelX "Y [m]"
        	LabelY "RMS ux"
		grid
		Width 10cm
         	Include_Description_Curves 0
         	Curve {
		legend "RK3, facsec = 1.8" 
                file RK3/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
		Curve {
		legend "RK3_impl, facsec = 1.8" 
                file RK3_impl/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
		Curve {
		legend "RK3_2, facsec = 0.9" 
                file RK3_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
		Curve {
		legend "RK3_impl_2, facsec = 0.9" 
                file RK3_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}

	}
	
	Figure {
		Dimension 2
		Title "Comparisons for RK3 : dt explicit vs semi-implicit"
        	LabelX "t [s]"
        	LabelY "dt [s]"
		grid
		Width 10cm
         	Include_Description_Curves 0
		Curve {
		legend "RK3, facsec = 1.8" 
                file RK3/Cas.dt_ev
                columns ($1) ($2)
                Style lines
		}
		Curve {
		legend "RK3_impl, facsec = 1.8" 
                file RK3_impl/Cas.dt_ev
                columns ($1) ($2)
                Style lines
		}
	}
	
		
	Figure {
		Dimension 2
		Title "Comparisons for RRK2 : facsec 1.4 vs 0.7"
        	LabelX "Y [m]"
        	LabelY "RMS ux"
		grid
		Width 10cm
         	Include_Description_Curves 0
         	Curve {
		legend "RRK2, facsec = 1.4" 
                file RRK2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
		Curve {
		legend "RRK2_impl, facsec = 1.4" 
                file RRK2_impl/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
		Curve {
		legend "RRK2_2, facsec = 0.7" 
                file RRK2_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}
		Curve {
		legend "RRK2_impl_2, facsec = 0.7" 
                file RRK2_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($5)
                Style lines
		}

	}
	
		Figure {
		Dimension 2
		Title "Comparisons for RRK2 : dt explicit vs semi-implicit"
        	LabelX "t [s]"
        	LabelY "dt [s]"
		grid
		Width 10cm
         	Include_Description_Curves 0
         	Curve {
		legend "RRK2, facsec = 1.4" 
                file RRK2/Cas.dt_ev
                columns ($1) ($2)
                Style lines
		}
		Curve {
		legend "RRK2_impl, facsec = 1.4" 
                file RRK2_impl/Cas.dt_ev
                columns ($1) ($2)
                Style lines
		}

	}

	
}


Chapter {
	title "RMS uy comparisons"
	Description "\latex_( Same observation as before ... Here, we see also that large facsec values for RRK2 and RK3 with a semi-implicit option predict zero RMS (transitional zone is blocked with large dt values for same reason as stated before)!!! Improved results are obtained when the facsec is divided by 2. NOTE: a convergence and a sensitivity analysis should be done (not considered here). \latex_)"

	Figure {
		Dimension 2
		Title "Large facsec values : wrong results"
        	LabelX "Y [m]"
        	LabelY "RMS uy"
		grid
		Width 10cm
         	Include_Description_Curves 0
		Curve {
		legend "RRK2, facsec = 1.4" 
                file RRK2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($6)
                Style lines
		}
		Curve {
		legend "RRK2_impl, facsec = 1.4" 
                file RRK2_impl/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($6)
                Style points
		}
		Curve {
		legend "AB2, facsec = 0.8" 
                file AB2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($6)
                Style lines
		}
		Curve {
		legend "AB2_impl, facsec = 0.8" 
                file AB2_impl/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($6)
                Style lines
		}
		Curve {
		legend "RK3, facsec = 1.8" 
                file RK3/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($6)
                Style lines
		}
		Curve {
		legend "RK3_impl, facsec = 1.8" 
                file RK3_impl/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($6)
                Style points
		}
	}


	
	Figure {
		Dimension 2
		Title "Smaller facsec values : OK"
        	LabelX "Y [m]"
        	LabelY "RMS uy"
		grid
		Width 10cm
         	Include_Description_Curves 0
		Curve {
		legend "RRK2_2, facsec = 0.7" 
                file RRK2_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($6)
                Style lines
		}
		Curve {
		legend "RRK2_impl_2, facsec = 0.7" 
                file RRK2_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($6)
                Style lines
		}
		Curve {
		legend "AB2_2, facsec = 0.4" 
                file AB2_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($6)
                Style lines
		}
		Curve {
		legend "AB2_impl_2, facsec = 0.4" 
                file AB2_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($6)
                Style lines
		}
		Curve {
		legend "RK3_2, facsec = 0.9" 
                file RK3_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($6)
                Style lines
		}
		Curve {
		legend "RK3_impl_2, facsec = 0.9" 
                file RK3_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($6)
                Style lines
		}
	}

	
}

Chapter {
	title "RMS uz comparisons"
	Description "\latex_( Nothing new to comment on... \latex_)"

	Figure {
		Dimension 2
		Title "Large facsec values : wrong results"
        	LabelX "Y [m]"
        	LabelY "RMS uz"
		grid
		Width 10cm
         	Include_Description_Curves 0
		Curve {
		legend "RRK2, facsec = 1.4" 
                file RRK2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($7)
                Style lines
		}
		Curve {
		legend "RRK2_impl, facsec = 1.4" 
                file RRK2_impl/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($7)
                Style points
		}
		Curve {
		legend "AB2, facsec = 0.8" 
                file AB2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($7)
                Style lines
		}
		Curve {
		legend "AB2_impl, facsec = 0.8" 
                file AB2_impl/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($7)
                Style lines
		}
		Curve {
		legend "RK3, facsec = 1.8" 
                file RK3/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($7)
                Style lines
		}
		Curve {
		legend "RK3_impl, facsec = 1.8" 
                file RK3_impl/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($7)
                Style points
		}
	}


	
	Figure {
		Dimension 2
		Title "Smaller facsec values : OK"
        	LabelX "Y [m]"
        	LabelY "RMS uz"
		grid
		Width 10cm
         	Include_Description_Curves 0
		Curve {
		legend "RRK2_2, facsec = 0.7" 
                file RRK2_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($7)
                Style lines
		}
		Curve {
		legend "RRK2_impl_2, facsec = 0.7" 
                file RRK2_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($7)
                Style lines
		}
		Curve {
		legend "AB2_2, facsec = 0.4" 
                file AB2_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($7)
                Style lines
		}
		Curve {
		legend "AB2_impl_2, facsec = 0.4" 
                file AB2_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($7)
                Style lines
		}
		Curve {
		legend "RK3_2, facsec = 0.9" 
                file RK3_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($7)
                Style lines
		}
		Curve {
		legend "RK3_impl_2, facsec = 0.9" 
                file RK3_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($7)
                Style lines
		}
	}

	
}

Chapter {

	title "Comparisons of different quantities"
	Description "\latex_(We provide comparisons in this section for the different quantities (see label of each axis in figures 6.1 - 6.3). Only the smaller facsec values are considered. \latex_)"
	
	Figure {
		Dimension 2
		Title "<ux>"
        	LabelX "Y [m]"
        	LabelY "<ux>"
		grid
		Width 10cm
         	Include_Description_Curves 0
		Curve {
		legend "RRK2_2, facsec = 0.7" 
                file RRK2_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($2)
                Style lines
		}
		Curve {
		legend "RRK2_impl_2, facsec = 0.7" 
                file RRK2_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($2)
                Style lines
		}
		Curve {
		legend "AB2_2, facsec = 0.4" 
                file AB2_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($2)
                Style lines
		}
		Curve {
		legend "AB2_impl_2, facsec = 0.4" 
                file AB2_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($2)
                Style lines
		}
		Curve {
		legend "RK3_2, facsec = 0.9" 
                file RK3_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($2)
                Style lines
		}
		Curve {
		legend "RK3_impl_2, facsec = 0.9" 
                file RK3_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($2)
                Style lines
		}
	}

	Figure {
		Dimension 2
		Title "<ux.uy> - <ux><uy>"
        	LabelX "Y [m]"
        	LabelY "<ux.uy> - <ux><uy>"
		grid
		Width 10cm
         	Include_Description_Curves 0
		Curve {
		legend "RRK2_2, facsec = 0.7" 
                file RRK2_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($8)
                Style lines
		}
		Curve {
		legend "RRK2_impl_2, facsec = 0.7" 
                file RRK2_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($8)
                Style lines
		}
		Curve {
		legend "AB2_2, facsec = 0.4" 
                file AB2_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($8)
                Style lines
		}
		Curve {
		legend "AB2_impl_2, facsec = 0.4" 
                file AB2_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($8)
                Style lines
		}
		Curve {
		legend "RK3_2, facsec = 0.9" 
                file RK3_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($8)
                Style lines
		}
		Curve {
		legend "RK3_impl_2, facsec = 0.9" 
                file RK3_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($8)
                Style lines
		}
	}
	Figure {
		Dimension 2
		Title "<ux.uz> - <ux><uz>"
        	LabelX "Y [m]"
        	LabelY "<ux.uz> - <ux><uz>"
		grid
		Width 10cm
         	Include_Description_Curves 0
		Curve {
		legend "RRK2_2, facsec = 0.7" 
                file RRK2_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($9)
                Style lines
		}
		Curve {
		legend "RRK2_impl_2, facsec = 0.7" 
                file RRK2_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($9)
                Style lines
		}
		Curve {
		legend "AB2_2, facsec = 0.4" 
                file AB2_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($9)
                Style lines
		}
		Curve {
		legend "AB2_impl_2, facsec = 0.4" 
                file AB2_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($9)
                Style lines
		}
		Curve {
		legend "RK3_2, facsec = 0.9" 
                file RK3_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($9)
                Style lines
		}
		Curve {
		legend "RK3_impl_2, facsec = 0.9" 
                file RK3_impl_2/Moyennes_spatiales_vitesse_rho_mu_fin
                columns ($1) ($9)
                Style lines
		}
	}
	
	
	
	
	
		
	

	
}


Chapter {
	title "Conclusions"
	Description "\latex_( In this report, comparisons between explicit and semi-implicit (diffusion implicit) schemes are presented.  A periodic channel test case is investigated in its laminar-to-turbulent transitional behavior. We show that the time step should be carefully controlled otherwise the transition is not reproduced. The \textbf{facsec} parameter of TRUST helps in reducing the timestep and thus can be used to control dt. We also show that results obtained with a semi-implicit scheme can match well with those predicted by a pure explicit one (if a good time-step is used). We note that the Adam-Bashforth scheme requires small time steps (facsec = 0.4 considered here for a particular mesh) in order to reproduce correctly the transition. Similarly for RRK2 and RK3 where the facsec should be 0.7 and 0.9 respectively (mainly when the viscous term is implicitly treated). A grid sensitivity analysis (not considered in this study) might also be interesting to analyze how the facsec behaves with the mesh refinement.  \latex_)"
	
	}


Chapter {
        Title "Computer performance"
        tableau_performance {
        }
}

