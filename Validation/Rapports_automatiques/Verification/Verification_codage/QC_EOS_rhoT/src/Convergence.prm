Parametres {
	Titre "Verification of 2D stationary laminar Navier-Stokes equation with variable density and viscosity"

	Castest VDF_maillage_1_1000_amont Cas
	Castest VDF_maillage_2_1000_amont Cas
	Castest VDF_maillage_3_1000_amont Cas
	Castest VDF_maillage_4_1000_amont Cas
	Castest VDF_maillage_5_1000_amont Cas
	Castest VDF_maillage_6_1000_amont Cas
	Castest VDF_maillage_7_1000_amont Cas
	Castest VDF_maillage_8_1000_amont Cas

	Castest VDF_maillage_1_1000_quick Cas
	Castest VDF_maillage_2_1000_quick Cas
	Castest VDF_maillage_3_1000_quick Cas
	Castest VDF_maillage_4_1000_quick Cas
	Castest VDF_maillage_5_1000_quick Cas
	Castest VDF_maillage_6_1000_quick Cas
	Castest VDF_maillage_7_1000_quick Cas
	Castest VDF_maillage_8_1000_quick Cas

	Castest VDF_maillage_1_1000_centre Cas
	Castest VDF_maillage_2_1000_centre Cas
	Castest VDF_maillage_3_1000_centre Cas
	Castest VDF_maillage_4_1000_centre Cas
	Castest VDF_maillage_5_1000_centre Cas
	Castest VDF_maillage_6_1000_centre Cas
	Castest VDF_maillage_7_1000_centre Cas
	Castest VDF_maillage_8_1000_centre Cas

	Castest VDF_maillage_1_1100_amont Cas
	Castest VDF_maillage_2_1100_amont Cas
	Castest VDF_maillage_3_1100_amont Cas
	Castest VDF_maillage_4_1100_amont Cas
	Castest VDF_maillage_5_1100_amont Cas
	Castest VDF_maillage_6_1100_amont Cas
	Castest VDF_maillage_7_1100_amont Cas
	Castest VDF_maillage_8_1100_amont Cas

	Castest VDF_maillage_1_1100_quick Cas
	Castest VDF_maillage_2_1100_quick Cas
	Castest VDF_maillage_3_1100_quick Cas
	Castest VDF_maillage_4_1100_quick Cas
	Castest VDF_maillage_5_1100_quick Cas
	Castest VDF_maillage_6_1100_quick Cas
	Castest VDF_maillage_7_1100_quick Cas
	Castest VDF_maillage_8_1100_quick Cas

	Castest VDF_maillage_1_1100_centre Cas
	Castest VDF_maillage_2_1100_centre Cas
	Castest VDF_maillage_3_1100_centre Cas
	Castest VDF_maillage_4_1100_centre Cas
	Castest VDF_maillage_5_1100_centre Cas
	Castest VDF_maillage_6_1100_centre Cas
	Castest VDF_maillage_7_1100_centre Cas
	Castest VDF_maillage_8_1100_centre Cas

	Auteur "Pierre-Emmanuel Angeli \& Elie Saikali"
	VersionTrio_U 1.8.3

}

Chapitre {
	Titre "Description"
	Description "$\bullet$ Mass conservation equation at the stationary state:"
	Description "\smallskip"
	Description "\latex_(\begin{equation}\dfrac{\partial \rho u_i}{\partial x_i}=0\end{equation}\latex_)"
	Description "\smallskip"
	Description "$\bullet$ Steady-state Navier-Stokes equation (without turbulence model) with a source term \latex_($\mathbf{R} = (R_1,R_2)$\latex_):"
	Description "\smallskip"
	Description "\latex_(\begin{equation}\forall i \in \{1 ; 2\}\text{: } \underbrace{\dfrac{\partial (\rho u_i u_j)}{\partial x_j}}_\text{Conv} = - \dfrac{\partial p}{\partial x_i} + \underbrace{\dfrac{\partial}{\partial x_j} \left[ \mu \left( \dfrac{\partial u_i}{\partial x_j} + \dfrac{\partial u_j}{\partial x_i} - \dfrac{2}{3} \dfrac{\partial u_k}{\partial x_k} \delta_{ij} \right)\right]}_\text{Diff} + \rho R_i\end{equation}\latex_)"
	Description "\smallskip"
	Description "$\bullet$ The convection and diffusion terms are composed of several parts:"
	Description "\smallskip"
	Description "\latex_(\begin{equation}\left\{\begin{array}{lcl}\text{Conv} &=& \underbrace{u_j \dfrac{\partial \rho u_i}{\partial x_j}}_\text{Conv$_1$} + \underbrace{\rho u_i \dfrac{\partial u_j}{\partial x_j}}_\text{Conv$_2$} \\\\ \text{Diff} &=& \underbrace{\dfrac{\partial}{\partial x_j} \left( \mu \dfrac{\partial u_i}{\partial x_j} \right)}_\text{Diff$_1$} + \underbrace{\dfrac{\partial}{\partial x_j} \left( \mu \dfrac{\partial u_j}{\partial x_i} \right)}_\text{Diff$_2$} + \underbrace{\dfrac{\partial}{\partial x_i} \left( - \dfrac{2}{3} \mu \dfrac{\partial u_j}{\partial x_j} \right)}_\text{Diff$_3$}\end{array}\right.\end{equation}\latex_)"
	Description "\smallskip"
	Description "$\bullet$ In order to check the different terms of the Navier-Stokes equation, we consider a model equation with coefficients \latex_($\alpha$, $\beta$ et $\gamma$\latex_) equal to 0 or 1:"
	Description "\smallskip"
	Description "\latex_(\begin{equation}\boxed{\text{Conv$_1$} + \alpha \text{Conv$_2$} = - \dfrac{\partial p}{\partial x_i} + \text{Diff$_1$} + \beta \text{Diff$_2$} + \gamma \text{Diff$_3$} + \rho R_i^{(\alpha\beta\gamma)}}\end{equation}\latex_)"
	Description "\smallskip"
	Description "$\bullet$ The verification approach is as follows: we give ourselves a field of pressure, velocity and density verifying the mass conservation equation, and inject them into the model Navier-Stokes equation; this gives us an expression for the source \latex_($\mathbf{R}$\latex_). Then the numerical solution of the equation with this expression for \latex_($\mathbf{R}$\latex_) must converge to the chosen analytical pressure and velocity, because they are the solution of the problem under consideration."
	Description "\smallskip"
	Description "$\bullet$ The normalized errors between the numerical solutions and their analytical expressions are defined as:
	Description "\smallskip"
	Description "\latex_(\begin{equation}\left\{\begin{array}{ll}\text{error on the pressure field: } & \textbf{errp} = \frac{\displaystyle{\Big( \int_D \left( p - p_\text{ex} \right)^2 \Big)^{1/2}}}{\displaystyle{\Big( \int_D p_\text{ex}^2 \Big)^{1/2}}} \\\\ \text{error on the velocity field: } & \textbf{erru} = \frac{\displaystyle{\Big( \int_D \left\Vert \textbf{u} - \textbf{u}_\text{ex} \right\Vert^2 \Big)^{1/2}}}{\displaystyle{\Big( \int_D \left\Vert \textbf{u}_\text{ex} \right\Vert^2 \Big)^{1/2}}}\end{array}\right.\end{equation}\latex_)"
	Description "\smallskip"
	Description "$\bullet$ We check the mesh convergence by plotting the normalized errors in function of the number of degrees of freedom for pressure and velocity:"
	Description "\smallskip"
	Description "\latex_(\begin{equation}\begin{array}{l}\text{number of pressure unknowns: }\textbf{npu} = \text{(number of elements)} \\\\ \text{number of velocity unknowns: }\textbf{nuu} = \text{(dimension) $\times$ (number of faces)}  \end{array}\end{equation}\latex_)"
	Description "\smallskip"
	Description "$\bullet$ The verification is performed in VDF. We consider a family of cartesian grids of the unit square [0 ; 1] x [0 ; 1], with \latex_($N \times N$\latex_) nodes, namely \latex_($(N-1)^2$\latex_) cells."
	Description "\smallskip"
	Description "$\bullet$ We look for periodic fields satisfying the mass conservation equation (1), and such that the viscosity and the density are everywhere strictly positive. We choose the analytical fields as follows:"
	Description "\smallskip"
	Description "\latex_(\begin{equation}\left\{\begin{array}{lll}\text{molecular viscosity: } & \mu(x,y) = m \cos(2\pi x) \cos(2\pi y) + 2 & \text{(with $m$ = 0 or 1)}\\\\ \text{density: } & \rho(x,y) = \dfrac{1}{\sin(2\pi x) \sin(2\pi y) + 2} & \\\\ \text{pressure: } & p_\text{ex}(x,y) = \cos(2\pi x) \cos(2\pi y) & \\\\ \text{velocity: } & \textbf{u}_\text{ex}(x,y) = \displaystyle{ \begin{pmatrix} \sin(2\pi x) \sin(2\pi y) + 2 \\\\ 0 \end{pmatrix}} & \end{array}\right.\end{equation}\latex_)"
	Description "\smallskip"
	Description "$\bullet$ The expression of the source components \latex_($R_i^{(\alpha\beta\gamma)}$\latex_) can be arranged as shown below:"
	Description "\smallskip"
	Description "\latex_(\begin{equation}\begin{array}{lcl}\rho R_i^{(\alpha\beta\gamma)} &=& \Big[ A_{i1} + B_{i1} \cos(2 \pi x) \cos(2 \pi y) \Big] \sin(2 \pi x) \sin(2 \pi y) \\\\ &+& \Big[ A_{i2} + B_{i2} \sin(2 \pi x) \cos(2 \pi y) \Big] \sin(2 \pi x) \cos(2 \pi y) \\\\ &+& \Big[ A_{i3} + B_{i3} \cos(2 \pi x) \sin(2 \pi y) \Big] \cos(2 \pi x) \sin(2 \pi y) \\\\ &+& \Big[ A_{i4} + B_{i4} \cos(2 \pi x) \cos(2 \pi y) \Big] \cos(2 \pi x) \cos(2 \pi y)\end{array}\end{equation}\latex_)"
	Description "\smallskip"
	Description "with the following coefficients:"
	Description "\smallskip"
	Description "\latex_(\begin{equation}\displaystyle{\begin{bmatrix} A_{11} \\\\ A_{12} \\\\ A_{13} \\\\ A_{14} \end{bmatrix} = \begin{bmatrix} 8 \pi^2 \left( \beta - 2/3 \gamma + 2 \right) \\\\ - 2 \pi \\\\ 2 \alpha \pi \\\\ 0 \end{bmatrix} \text{, } \begin{bmatrix} B_{11} \\\\ B_{12} \\\\ B_{13} \\\\ B_{14} \end{bmatrix} = \begin{bmatrix} m A_{11} \\\\ 0 \\\\ 0 \\\\ 0 \end{bmatrix}}\end{equation}\latex_)
	Description "\smallskip"
	Description "and"
	Description "\smallskip"
	Description "\latex_(\begin{equation}\displaystyle{\begin{bmatrix} A_{21} \\\\ A_{22} \\\\ A_{23} \\\\ A_{24} \end{bmatrix} = \begin{bmatrix} 0 \\\\ 0 \\\\ - 2 \pi \\\\ - 8 \pi^2 \left( \beta - 2/3 \gamma \right) \end{bmatrix} \text{, } \begin{bmatrix} B_{21} \\\\ B_{22} \\\\ B_{23} \\\\ B_{24} \end{bmatrix} = \begin{bmatrix} 0 \\\\ 4 \beta m \pi^2 \\\\ -8/3 \gamma m \pi^2 \\\\ m A_{24} / 2 \end{bmatrix}}\end{equation}\latex_)
	Description "\smallskip"
	Description "$\bullet$ We use periodic boundary conditions along with source terms of type \latex_( \texttt{canal\_perio} \latex_) in order to prescribe the mass flow rate in each direction (otherwise the simulation can't reach a steady-state, because the solution is not unique)."
	Description "\smallskip"
	Description "$\bullet$ We use \latex_($\gamma = 0$\latex_), because the third diffusive term is not available yet. We use \latex_($\alpha$\latex_) and \latex_($\beta$\latex_) equal to 0 or 1. "
}

Chapitre {
	Titre "Convergence results in the case 1000"
	Figure {
		titre_figure errp
		Width 12cm
		Dimension 2
		LabelX "npu"
		LabelY "errp^2"
		RangeX auto auto
		LogX
		LogY
		InclureDescCourbes 0
		Legende below
		Courbe {
			Legende "order = 2"
			Fonction 1000*x**(-2)
			Style lines
			Typeligne 0
			}
		Courbe {
			Legende "1000_amont"
			Fichier ./VDF_errp_1000_amont.dat
			Colonnes ($1) ($2)**2
			Style linespoints
			TypeLigne 20
			TypePoints 7
			PointSize 1.5
			}
		Courbe {
			Legende "1000_quick"
			Fichier ./VDF_errp_1000_quick.dat
			Colonnes ($1) ($2)**2
			Style linespoints
			TypeLigne 3
			TypePoints 7
			PointSize 1.5
			}
		Courbe {
			Legende "1000_centre"
			Fichier ./VDF_errp_1000_centre.dat
			Colonnes ($1) ($2)**2
			Style linespoints
			TypeLigne 4
			TypePoints 7
			PointSize 1.5
			}
		}
	Figure {
		titre_figure erru
		Width 12cm
		Dimension 2
		LabelX "nuu"
		LabelY "erru^2"
		RangeX auto auto
		LogX
		LogY
		InclureDescCourbes 0
		Legende below
		Courbe {
			Legende "order = 2"
			Fonction 10*x**(-2)
			Style lines
			Typeligne 0
			}
		Courbe {
			Legende "1000_amont"
			Fichier ./VDF_erru_1000_amont.dat
			Colonnes ($1) ($2)**2
			Style linespoints
			TypeLigne 20
			TypePoints 7
			PointSize 1.5
			}
		Courbe {
			Legende "1000_quick"
			Fichier ./VDF_erru_1000_quick.dat
			Colonnes ($1) ($2)**2
			Style linespoints
			TypeLigne 3
			TypePoints 7
			PointSize 1.5
			}
		Courbe {
			Legende "1000_centre"
			Fichier ./VDF_erru_1000_centre.dat
			Colonnes ($1) ($2)**2
			Style linespoints
			TypeLigne 4
			TypePoints 7
			PointSize 1.5
			}
		}
}

Chapitre {
	Titre "Convergence results in the case 1100"
	Figure {
		titre_figure errp
		Width 12cm
		Dimension 2
		LabelX "npu"
		LabelY "errp^2"
		RangeX auto auto
		LogX
		LogY
		InclureDescCourbes 0
		Legende below
		Courbe {
			Legende "order = 2"
			Fonction 1000*x**(-2)
			Style lines
			Typeligne 0
			}
		Courbe {
			Legende "1100_amont"
			Fichier ./VDF_errp_1100_amont.dat
			Colonnes ($1) ($2)**2
			Style linespoints
			TypeLigne 20
			TypePoints 7
			PointSize 1.5
			}
		Courbe {
			Legende "1100_quick"
			Fichier ./VDF_errp_1100_quick.dat
			Colonnes ($1) ($2)**2
			Style linespoints
			TypeLigne 3
			TypePoints 7
			PointSize 1.5
			}
		Courbe {
			Legende "1100_centre"
			Fichier ./VDF_errp_1100_centre.dat
			Colonnes ($1) ($2)**2
			Style linespoints
			TypeLigne 4
			TypePoints 7
			PointSize 1.5
			}
		}
	Figure {
		titre_figure erru
		Width 12cm
		Dimension 2
		LabelX "nuu"
		LabelY "erru^2"
		RangeX auto auto
		LogX
		LogY
		InclureDescCourbes 0
		Legende below
		Courbe {
			Legende "order = 2"
			Fonction 10*x**(-2)
			Style lines
			Typeligne 0
			}
		Courbe {
			Legende "1100_amont"
			Fichier ./VDF_erru_1100_amont.dat
			Colonnes ($1) ($2)**2
			Style linespoints
			TypeLigne 20
			TypePoints 7
			PointSize 1.5
			}
		Courbe {
			Legende "1100_quick"
			Fichier ./VDF_erru_1100_quick.dat
			Colonnes ($1) ($2)**2
			Style linespoints
			TypeLigne 3
			TypePoints 7
			PointSize 1.5
			}
		Courbe {
			Legende "1100_centre"
			Fichier ./VDF_erru_1100_centre.dat
			Colonnes ($1) ($2)**2
			Style linespoints
			TypeLigne 4
			TypePoints 7
			PointSize 1.5
			}
		}
}


Chapitre {
	Titre "Computer performance"
	Tableau_performance {
	}
}
