Parameters {
    Title "3D examples to post-process the pressure for incompressible flow"
    Author "MR"
    VersionTrio_U 1.7.6
    Description "This report was made to show how to post-process the pressure field with TRUST. The idea is to know what is coded behind the keywords: pression, pression_Pa, pressure, P_star, pression_hydrostatique on an analytic case. At last, you can find a part about how to post-process the total pressure."
    TestCase PAR_VEF_P0P1_g_muscl       PAR_VEF_P0P1_g_muscl.data           3     attached
    TestCase PAR_VEF_P0P1_g_negligeable PAR_VEF_P0P1_g_negligeable.data     3
    TestCase PAR_VEF_P0P1_g_ef_stab     PAR_VEF_P0P1_g_ef_stab.data         3
    TestCase PAR_VEF_P0P1_gx_muscl      PAR_VEF_P0P1_gx_muscl.data          3
    TestCase PAR_VEF_P0P1_gx_ef_stab    PAR_VEF_P0P1_gx_ef_stab.data        3
    TestCase PAR_VEF_P0P1_gx_negligeable    PAR_VEF_P0P1_gx_negligeable.data        3
}

###################################################################################################################
Chapter {
    Description "\newpage"
}
Chapter {
    Description "\tableofcontents"
}
###################################################################################################################



###################################################################################################################
Chapter {
    Title "General informations"
    Description "\latex_(\subsection{Poiseuille flow} \latex_)"
    Description "\latex_( Consider a laminar flow ($Re<2000$) of a fluid of viscosity $\mu$ and density $\rho$, in a cylindrical pipe of radius $R=0.1$, placed horizontally. The next graph explains this configuration and makes it possible to define a cylindrical reference mark whose axis of revolution is that of the pipe and corresponds to the direction of the laminar flow. \begin{center} \includegraphics[scale=1]{\orig/.tmp/../fig} \par\end{center} Under these conditions, since the flow is laminar, the velocity vector at every point is written: $$\vec{V}=v_r \vec{e}_r + v_{\theta} \vec{e}_{\theta} + v_x \vec{e}_x=u(r,\theta,x) \vec{e}_x$$ as here $v_r=v_{\theta}=0$. \\ Then in cylindrical coordinates: $$ \nabla \cdot \vec{V} = 0 = \frac{1}{r} \frac{\partial (r v_r)}{\partial r} + \frac{1}{r} \frac{\partial v_{\theta}}{\partial \theta} + \frac{\partial v_x}{\partial x} = \frac{\partial u}{\partial x}=0$$ \\ So $ \vec{V}=u(r,\theta) \vec{e}_x $. And by symmetry of revolution $ \frac{\partial v_{\theta}}{\partial \theta} =0 $ so: $$ \vec{V}=u(r) \vec{e}_x$$ Now take the equation governing the evolution of the total pressure $P_t(=p+\rho g z + \frac{1}{2}\rho v^2)$ along a laminar flow oriented along the axis $x$: $$\frac{dP_t}{dx}=\mu \Delta u$$  And develop the expression of the Laplacian taking into account the fact that $u$ depends only on $x$: $$\frac{dP_t}{dx}=\mu \frac{1}{r} \frac{\partial}{\partial r} \left(r \frac{\partial u}{\partial r}\right)$$ Where the left-hand term depends only on $x$ and on the right-hand side only $r$. It follows that the members of this equation are equal to the same constant K. Thus, we have: \\ $\displaystyle{\frac{dP_t}{dx}=K}$ reflecting the regular pressure drop; \\ $\displaystyle{\mu \frac{1}{r} \frac{\partial}{\partial r} \left(r \frac{\partial u}{\partial r}\right)}$ allowing the determination of the velocity profile.\\ Solving the second equation, we have: $$u(r)=\frac{K}{4 \mu} r^2 + K^{'} ln(r) + K^{''}$$ Using $u(r=R)=0$ and $u(r=0)=u_{max}$ then: $$u(r)=\frac{K}{4 \mu} (r^2-R^2)$$ And we can write $u_{max}=u(0)=-\frac{KR^2}{4\mu}$ so $$K=-\frac{4 \mu}{R^2} u_{max}$$ The average velocity $V_{moy}=<u>$ can be expressed in function of the volume flow rate $Q_v$: $$<u>=\frac{Q_v}{S}=\frac{1}{\pi R^2} \iint V \cdot \vec{n} dS = \frac{1}{\pi R^2} \iint u(r) dS=\frac{1}{\pi R^2} \int_0^R u(r) 2 \pi r dr= -\frac{KR^2}{8\mu}=-\frac{u_{max}}{2}$$ with $S=\pi R^2$ so $dS=2\pi r dr$. So $\displaystyle{Q_v=<u> S=<u>\pi R^2 =-\frac{K \pi R^4}{8 \mu}}$.\\ Then $\displaystyle{\frac{dP_t}{dx}=K}$ leads to: $$\Delta P_t =-\frac{dP_t}{dx} \Delta x=-K \Delta x= \frac{8 \mu <u> L}{R^2}$$ with $L=\Delta x$ the length of the pipe.\\ Set $D=2R$ the height of the pipe (diameter) and $v=<u>$ the average velocity, then: $$\Delta P_t=\frac{8 \mu v L}{(D/2)^2}=\left(\frac{1}{2}\rho v^2\right)\left(\frac{64 \mu}{\rho v D}\right)\frac{L}{D} = \left(\frac{1}{2}\rho v^2\right)\left(\frac{64}{Re}\right)\frac{L}{D}$$ with $Re=\frac{\rho v D}{\mu}$ the Reynolds number where $\lambda=\frac{64}{Re}$ is the coefficient of pressure loss.\\ \\Reference: \textcolor{blue}{http://res-nlp.univ-lemans.fr/NLP\_C\_M02\_G02/co/Contenu\_29.html}\latex_)"
################################################################
################################################################

    visu {
        Title "Geometry used: VEF mesh"
        Description "Here we made calculs on a column of water. \\ Inlet mesh done with gmsh then extrude with TRUST."
        Description include_text_file(PAR_VEF_P0P1_g_muscl/nb_elem_tot.txt)
        Width       10cm
        mesh        PAR_VEF_P0P1_g_muscl/PAR_VEF_P0P1_g_muscl.lata              dom
        up3d        -0.01 0.08 1
        normal3D    0.6 -0.81 0.07
    }

################################################################
################################################################

    visu {
        Title "Probes localisation on Inlet and Outlet boundaries"
        Description "The meshes are the same on the Inlet and Outlet."
        Description "\latex_(Coordinates of the \textcolor{red}{red} probe: \latex_)"include_text_file(PAR_VEF_P0P1_g_muscl/probe1.txt)
        Description "\latex_(Coordinates of the \textcolor{green}{green} probe: \latex_)"include_text_file(PAR_VEF_P0P1_g_muscl/probe2.txt)
        Width       12cm
        mesh        PAR_VEF_P0P1_g_muscl/PAR_VEF_P0P1_g_muscl_P_TOT1DRAWA.son      MESH red
        Instruction_visit m.pointSizePixels=10
        Instruction_visit SetPlotOptions(m)
        mesh        PAR_VEF_P0P1_g_muscl/PAR_VEF_P0P1_g_muscl_P_TOT2DRAWA.son      MESH green
        Instruction_visit m.pointSizePixels=10
        Instruction_visit SetPlotOptions(m)
        mesh        PAR_VEF_P0P1_g_muscl/PAR_VEF_P0P1_g_muscl.lata            dom_boundaries/Inlet
        up3d        0 0 1
        normal3D    -1 0 0
        zoom3D      0.15 0.15 0.8
    }

################################################################
################################################################

    Table {
        Title "Physical properties of the fluid" 
        nb_columns 1
        line {
            legend "Density $\rho$ ($kg/m^3$)"
            file PAR_VEF_P0P1_g_muscl/propertiesGeometry.dat    
            nb_columns_file 5
            columns ($2)
        }
        line {
            legend "Dynamic viscosity $\mu$ ($kg/(m.s)$)"
            file PAR_VEF_P0P1_g_muscl/propertiesGeometry.dat
            nb_columns_file 5
            columns ($1)
        }
    }

################################################################
################################################################

    Table {
        Title "Flow characteristics"
        nb_columns 1
        line {
            legend \latex_($u_{max}$\latex_)
            file PAR_VEF_P0P1_g_muscl/propertiesGeometry.dat
            nb_columns_file 17
            columns ($3)
        }
        line {
            legend \latex_($u_{moy}$\latex_)
            file PAR_VEF_P0P1_g_muscl/propertiesGeometry.dat
            nb_columns_file 17
            columns ($4)
        }
        line {
            legend Reynolds number Re
            file PAR_VEF_P0P1_g_muscl/propertiesGeometry.dat
            nb_columns_file 17
            columns ($6)
        }
        line {
            legend Theorical volume flow rate \latex_($Q_v$\latex_)
            file PAR_VEF_P0P1_g_muscl/propertiesGeometry.dat
            nb_columns_file 17
            columns ($5)
        }
        line {
            legend $\Delta$P theoretical
            file PAR_VEF_P0P1_g_muscl/propertiesGeometry.dat
            nb_columns_file 17
            columns ($7)
        }
    }

################################################################
################################################################

    Table {
        Title "Initial conditions"
        Description include_text_file(IC.txt, initial_conditions, boundary_conditions, vitesse, Champ_Uniforme, paroi_fixe, Frontiere_ouverte_vitesse_imposee, Champ_front_Uniforme, Frontiere_ouverte_pression_imposee)
    }

################################################################
################################################################

    Table {
        Title "Boundary conditions"
        Description include_text_file(CL.txt, initial_conditions, boundary_conditions, Champ_Uniforme, paroi_fixe, Frontiere_ouverte_vitesse_imposee, Champ_front_Uniforme, Frontiere_ouverte_pression_imposee, champ_front_fonc_xyz)
    }

    Table {
        Description "\newpage"
    }
}
###################################################################################################################



###################################################################################################################
Chapter {
    Title "\latex_( Cylinder belong z axis and $\vec{g}=-g \vec{e}_z$ \latex_)"

    Table {
        Title "Gravity vector" 
        Description include_text_file(gravity.txt, Champ_Uniforme, Read)
    }

################################################################
################################################################

    visu {
        Title       "Initial state: Velocity field" 
        Description "\latex_( We impose in inlet: $$u(r)=\frac{K}{4 \mu} \left(r^2-R^2\right)=-\frac{u_{max}}{R^2} \left(r^2-R^2\right)$$ with $u_{max}=u(0)=0.01$, $R=0.1$ and $r=y^2+z^2$ \latex_)"
        Width       12cm
        cycles 0
        pseudocolor  PAR_VEF_P0P1_g_muscl/PAR_VEF_P0P1_g_muscl.lata              dom_dual_magnitude    VITESSE FACES
        up3d        0 1 -0.08
        normal3D    -0.65 0.1 0.75
        zoom3D      0.15 0.15 0.8
    }

    visu {
        title       "Initial state: Pressure field"
        Description "The imposed pressure in boundary condition correspond to the TRUST field named 'Pressure'. This is the Navier-Stokes pressure \latex_($P_{NS}$ \latex_) in Pascals (for incompressible flow):"
        Description "\latex_(\textbf{$P_{NS}$ ='Pression\_Pa'='Pressure' in [Pa]}. \latex_)"
        Width       9cm
        cycles 0
        pseudocolor_with_range  PAR_VEF_P0P1_g_muscl/PAR_VEF_P0P1_g_muscl.lata              dom    PRESSION_PA ELEM  0.01 10
        up3d        -0.01 0.08 1
        normal3D    0.6 -0.81 0.07
        zoom3D      0.15 0.15 0.8
    }

    visu {
        Description "\latex_(and: \textbf{'Pression' = 'P\_star' = $ \frac{1}{\rho} P_{NS}$ in $[m^2/s^2]$}. \latex_)"
        Width       9cm
        cycles 0
        pseudocolor_with_range  PAR_VEF_P0P1_g_muscl/PAR_VEF_P0P1_g_muscl.lata              dom    PRESSION ELEM  0.01 10
        up3d        -0.01 0.08 1
        normal3D    0.6 -0.81 0.07
        zoom3D      0.15 0.15 0.8
    }

################################################################
################################################################

    Table {
        Title "Mean of the pressure field at the Outlet"
        Description "We want to verify the pressure at the outlet of the cylinder where we imposed the pressure field to be 10. For that we create a new field with the 'Definition_champ' TRUST keyword."
        Description "Syntax of the Definition_champ block for the mean of the 'pression' field on the outlet in the data file:"include_text_file(mean_pression_outlet.txt, Reduction_0D, methode, moyenne, source, interpolation, domaine, localisation, elem, refChamp ,Pb_champ, pression, pression_pa)
        Description "Syntax of the probe line in the data file:"include_text_file(mean_pression_outlet_probe.txt, periode, numero_elem_sur_maitre)

        Description "  "
        Description "The obtained values confirm that Navier-stokes pressure \latex_(\textbf{$P_{NS}$ ='Pression\_Pa'='Pressure'} in [Pa] and \textbf{'Pression' = 'P\_star' = $ \frac{1}{\rho} P_{NS}$} in $[m^2/s^2]$ \latex_)"
        nb_columns 1
        line {
            legend "Mean 'Pression_Pa' field in Pascals"
            file PAR_VEF_P0P1_g_muscl/mean_pressure.dat
            nb_columns_file 4
            columns ($2)
        }
        line {
            legend "Mean 'Pressure' field in Pascals"
            file PAR_VEF_P0P1_g_muscl/mean_pressure.dat
            nb_columns_file 4
            columns ($3)
        }
        line {
            legend "Mean 'Pression' field in $[m^2/s^2]$"
            file PAR_VEF_P0P1_g_muscl/mean_pressure.dat
            nb_columns_file 4
            columns ($1)
        }
        line {
            legend "Mean 'P_Star' field in $[m^2/s^2]$"
            file PAR_VEF_P0P1_g_muscl/mean_pressure.dat
            nb_columns_file 4
            columns ($4)
        }
    }

################################################################
################################################################

    Table {
        Title "Flow rate"
        nb_columns 3
        label "Theorical volume flow rate" | "TRUST volume flow rate" | "Error on \latex_($Q_v$\latex_) in $%$"
        line {
            legend "Muscl"
            file PAR_VEF_P0P1_g_muscl/propertiesGeometry.dat
            nb_columns_file 17
            columns ($5) ($16) ($17)
        }
#        line {
#            legend "Amont"
#            file PAR_VEF_P0P1_g_amont/propertiesGeometry.dat
#            nb_columns_file 17
#            columns ($5) ($16) ($17)
#        }
        line {
            legend "Ef_Stab"
            file PAR_VEF_P0P1_g_ef_stab/propertiesGeometry.dat
            nb_columns_file 17
            columns ($5) ($16) ($17)
        }
        line {
            legend "Negligeable"
            file PAR_VEF_P0P1_g_negligeable/propertiesGeometry.dat
            nb_columns_file 17
            columns ($5) ($16) ($17)
        }
    }

################################################################
################################################################

#    visu {
#        Title       "Velocity slice belong Y axis"
#        Width       12cm
#        pseudocolor PAR_VEF_P0P1_g_muscl/PAR_VEF_P0P1_g_muscl.lata   dom_dual_magnitude   VITESSE   FACES
#        Operator    slice2D       0 0 0 0 1 0
#    }

################################################################
################################################################

    figure { 
        Title "Velocity profil for a Poiseuille flow at final time step for x=0.05" 
        Description include_text_file(VITX_probe.txt, vitessex, segment, periode)
        Width 12cm
        include_description_curves 0
        labelX "z (m)"
        labelY "Velocity (m/s)"
        legend below title "Legend"
        curve {
            Fonction -0.01*(x**2-0.1**2)/0.1**2
            legend "Analytic solution"
            style lines
        }
        curve {
            Segment PAR_VEF_P0P1_g_muscl/PAR_VEF_P0P1_g_muscl.data VITX
            columns ($1) ($2)
            legend "Muscl vitX probe"
            style linespoints
        }
#        curve {
#            Segment PAR_VEF_P0P1_g_amont/PAR_VEF_P0P1_g_amont.data VITX
#            columns ($1) ($2)
#            legend "Amont vitX probe"
#            style linespoints
#        }
        curve {
            Segment PAR_VEF_P0P1_g_ef_stab/PAR_VEF_P0P1_g_ef_stab.data VITX
            columns ($1) ($2)
            legend "Ef_Stab vitX probe"
            style linespoints
        }
        curve {
            Segment PAR_VEF_P0P1_g_negligeable/PAR_VEF_P0P1_g_negligeable.data VITX
            columns ($1) ($2)
            legend "Negligeable vitX probe"
            style linespoints
        }
    }

################################################################
################################################################

#    visu {
#        Title       "Pressure slice belong Y axis"
#        Width       12cm
#        pseudocolor PAR_VEF_P0P1_g_muscl/PAR_VEF_P0P1_g_muscl.lata   dom   PRESSURE_TOT   ELEM
#        Operator    slice2D       0 0 0 0 1 0
#    }

################################################################
################################################################

    figure { 
        Title "Total pressure profil" 
        Description include_text_file(pression_tot.txt, Predefini, Transformation, methode, formule, expression, localisation, elem, sources_reference, energie_cinetique_elem, sources, RefChamp, Pb_champ, pression_pa, nom_source, pression_hydrostatique, masse_volumique )
        Width 12cm
        include_description_curves 0
        labelX "x (m)"
        labelY "Pressure (Pa)"
        legend below title "Legend"
#        curve {
#            Fonction -4*0.001002*0.01/0.1**2*(x-0.1)+10  
#            legend "Analytic solution"
#            style lines
#        }
        curve {
            Segment PAR_VEF_P0P1_g_muscl/PAR_VEF_P0P1_g_muscl.data PTOT
            columns ($1) ($2)
            legend "Muscl ptot probe"
            style linespoints
        }
#        curve {
#            Segment PAR_VEF_P0P1_g_amont/PAR_VEF_P0P1_g_amont.data PTOT
#            columns ($1) ($2)
#            legend "Amont ptot probe"
#            style linespoints
#        }
        curve {
            Segment PAR_VEF_P0P1_g_ef_stab/PAR_VEF_P0P1_g_ef_stab.data PTOT
            columns ($1) ($2)
            legend "Ef_Stab ptot probe"
            style linespoints
        }
        curve {
            Segment PAR_VEF_P0P1_g_negligeable/PAR_VEF_P0P1_g_negligeable.data PTOT
            columns ($1) ($2)
            legend "Negligeable ptot probe"
            style linespoints
        }
    }

################################################################
################################################################
# Analytic solution P=P(L)-K(x-L)
    figure { 
        Title "Pressure profil" 
        Width 12cm
        include_description_curves 0
        labelX "x (m)"
        labelY "Pressure (Pa)"
        legend below title "Legend"
        curve {
            Segment PAR_VEF_P0P1_g_muscl/PAR_VEF_P0P1_g_muscl.data P_PA
            columns ($1) ($2)
            legend "Muscl p_pa probe"
            style linespoints
        }
        curve {
            Segment PAR_VEF_P0P1_g_ef_stab/PAR_VEF_P0P1_g_ef_stab.data P_PA
            columns ($1) ($2)
            legend "Ef_Stab p_pa probe"
            style linespoints
        }
        curve {
            Segment PAR_VEF_P0P1_g_negligeable/PAR_VEF_P0P1_g_negligeable.data P_PA
            columns ($1) ($2)
            legend "Negligeable p_pa probe"
            style linespoints
        }
        curve {
            Fonction -4*0.001002*0.01/0.1**2*(x-0.1)+10  
            legend "Analytic solution"
            style lines
        }
    }

################################################################
################################################################
# Analytic solution en z=0, rho*g*z=0
    figure { 
        Title "Pressure hydrostatique profil" 
        Width 12cm
        include_description_curves 0
        labelX "x (m)"
        labelY "Pressure (Pa)"
        legend below title "Legend"
        curve {
            Fonction 0.
            legend "Analytic solution"
            style lines
        }
        curve {
            Segment PAR_VEF_P0P1_g_muscl/PAR_VEF_P0P1_g_muscl.data PRESSION_HYDRO
            columns ($1) ($2)
            legend "Muscl pression_hydro probe"
            style linespoints
        }
        curve {
            Segment PAR_VEF_P0P1_g_ef_stab/PAR_VEF_P0P1_g_ef_stab.data PRESSION_HYDRO
            columns ($1) ($2)
            legend "Ef_Stab pression_hydro probe"
            style linespoints
        }
        curve {
            Segment PAR_VEF_P0P1_g_negligeable/PAR_VEF_P0P1_g_negligeable.data PRESSION_HYDRO
            columns ($1) ($2)
            legend "Negligeable pression_hydro probe"
            style linespoints
        }
    }

################################################################
################################################################
# Analytic solution 0.5*rho*v**2
    figure { 
        Title "Kinetic energy profil" 
        Width 12cm
        include_description_curves 0
        labelX "x (m)"
        labelY "Pressure (Pa)"
        legend below title "Legend"
        curve {
            Fonction 0.5*1000*0.01*0.01
            legend "Analytic solution"
            style lines
        }
        curve {
            Segment PAR_VEF_P0P1_g_muscl/PAR_VEF_P0P1_g_muscl.data EC
            columns ($1) ($2)
            legend "Muscl ec probe"
            style linespoints
        }
        curve {
            Segment PAR_VEF_P0P1_g_ef_stab/PAR_VEF_P0P1_g_ef_stab.data EC
            columns ($1) ($2)
            legend "Ef_Stab ec probe"
            style linespoints
        }
        curve {
            Segment PAR_VEF_P0P1_g_negligeable/PAR_VEF_P0P1_g_negligeable.data EC
            columns ($1) ($2)
            legend "Negligeable ec probe"
            style linespoints
        }
    }
################################################################
################################################################

    Table {
        Title "Pressure drop on the mean of the pressure at the inlet and outlet"
        nb_columns 3
        label $\Delta$P theoretical | $\Delta$P TRUST | Error on $\Delta$P in $%$ 
        line {
            legend "Muscl"
            file PAR_VEF_P0P1_g_muscl/propertiesGeometry.dat
            nb_columns_file 17
            columns ($7) ($14) ($15)
        }
#        line {
#            legend "Amont"
#            file PAR_VEF_P0P1_g_amont/propertiesGeometry.dat
#            nb_columns_file 17
#            columns ($7) ($14) ($15)
#        }
        line {
            legend "Ef_Stab"
            file PAR_VEF_P0P1_g_ef_stab/propertiesGeometry.dat
            nb_columns_file 17
            columns ($7) ($14) ($15)
        }
        line {
            legend "Negligeable"
            file PAR_VEF_P0P1_g_negligeable/propertiesGeometry.dat
            nb_columns_file 17
            columns ($7) ($14) ($15)
        }
    }

################################################################
################################################################

    Table {
        Title "Pressure drop between the two symmetrical points of the probe 1"
        nb_columns 3
        label $\Delta$P theoretical | $\Delta$P TRUST | Error on $\Delta$P in $%$ 
        line {
            legend "Muscl"
            file PAR_VEF_P0P1_g_muscl/propertiesGeometry.dat
            nb_columns_file 17
            columns ($7) ($8) ($9)
        }
#        line {
#            legend "Amont"
#            file PAR_VEF_P0P1_g_amont/propertiesGeometry.dat
#            nb_columns_file 17
#            columns ($7) ($8) ($9)
#        }
        line {
            legend "Ef_Stab"
            file PAR_VEF_P0P1_g_ef_stab/propertiesGeometry.dat
            nb_columns_file 17
            columns ($7) ($8) ($9)
        }
        line {
            legend "Negligeable"
            file PAR_VEF_P0P1_g_negligeable/propertiesGeometry.dat
            nb_columns_file 17
            columns ($7) ($8) ($9)
        }
    }

################################################################
################################################################

#    Table {
#        Title "Pressure drop between the two symmetrical points of the probe 2"
#        nb_columns 3
#        label $\Delta$P theoretical | $\Delta$P TRUST | Error on $\Delta$P in $%$ 
#        line {
#            legend "Muscl"
#            file PAR_VEF_P0P1_g_muscl/propertiesGeometry.dat
#            nb_columns_file 17
#            columns ($7) ($10) ($11)
#        }
##        line {
##            legend "Amont"
##            file PAR_VEF_P0P1_g_amont/propertiesGeometry.dat
##            nb_columns_file 17
##            columns ($7) ($10) ($11)
##        }
#        line {
#            legend "Ef_Stab"
#            file PAR_VEF_P0P1_g_ef_stab/propertiesGeometry.dat
#            nb_columns_file 17
#            columns ($7) ($10) ($11)
#        }
#        line {
#            legend "Negligeable"
#            file PAR_VEF_P0P1_g_negligeable/propertiesGeometry.dat
#            nb_columns_file 17
#            columns ($7) ($10) ($11)
#        }
#    }

################################################################
################################################################

    Table {
        Title "Pressure drop between the two symmetrical points of the probe 3"
        nb_columns 3
        label $\Delta$P theoretical | $\Delta$P TRUST | Error on $\Delta$P in $%$ 
        line {
            legend "Muscl"
            file PAR_VEF_P0P1_g_muscl/propertiesGeometry.dat
            nb_columns_file 17
            columns ($7) ($12) ($13)
        }
#        line {
#            legend "Amont"
#            file PAR_VEF_P0P1_g_amont/propertiesGeometry.dat
#            nb_columns_file 17
#            columns ($7) ($12) ($13)
#        }
        line {
            legend "Ef_Stab"
            file PAR_VEF_P0P1_g_ef_stab/propertiesGeometry.dat
            nb_columns_file 17
            columns ($7) ($12) ($13)
        }
        line {
            legend "Negligeable"
            file PAR_VEF_P0P1_g_negligeable/propertiesGeometry.dat
            nb_columns_file 17
            columns ($7) ($12) ($13)
        }
    }

    Table {
        Description "\newpage"
    }
}

###################################################################################################################



###################################################################################################################

Chapter {
    Title "\latex_( Cylinder belong x axis and $\vec{g}=-g \vec{e}_x$ \latex_)"

    Table {
        Title "Gravity vector" 
        Description include_text_file(gravity_gx.txt, Champ_Uniforme, Read)
    }

################################################################
################################################################

    visu {
        Title       "Initial state: Velocity field" 
        Description "\latex_( We impose in inlet: $$u(r)=-\frac{u_{max}}{R^2} \left(r^2-R^2\right)$$ with $u_{max}=u(0)=0.01$, $R=0.1$ and $r=y^2+z^2$ \latex_)"
        Width       12cm
        cycles 0
        pseudocolor  PAR_VEF_P0P1_gx_muscl/PAR_VEF_P0P1_gx_muscl.lata              dom_dual_magnitude    VITESSE FACES
        up3d        0 1 -0.08
        normal3D    -0.65 0.1 0.75
        zoom3D      0.15 0.15 0.8
    }

    visu {
        title       "Initial state: Pressure field"
        Description "The imposed pressure in boundary condition correspond to the TRUST field named 'Pressure'. This is the Navier-Stokes pressure \latex_($P_{NS}$ \latex_) in Pascals (for incompressible flow):"
        Description "\latex_(\textbf{$P_{NS}$ ='Pression\_Pa'='Pressure' in [Pa]}. \latex_)"
#        Description "\latex_(and: \textbf{'Pression' = 'P\_star' = $ \frac{1}{\rho} P_{NS}$ in $[m^2/s^2]$}. \latex_)"
        Width       9cm
        cycles 0
        pseudocolor_with_range  PAR_VEF_P0P1_gx_muscl/PAR_VEF_P0P1_gx_muscl.lata              dom    PRESSION_PA ELEM  0.01 10
        up3d        -0.01 0.08 1
        normal3D    0.6 -0.81 0.07
        zoom3D      0.15 0.15 0.8
    }

    visu {
        Description "\latex_(and: \textbf{'Pression' = 'P\_star' = $ \frac{1}{\rho} P_{NS}$ in $[m^2/s^2]$}. \latex_)"
        Width       9cm
        cycles 0
        pseudocolor_with_range  PAR_VEF_P0P1_gx_muscl/PAR_VEF_P0P1_gx_muscl.lata              dom    PRESSION ELEM  0.01 10
        up3d        -0.01 0.08 1
        normal3D    0.6 -0.81 0.07
        zoom3D      0.15 0.15 0.8
    }

################################################################
################################################################

    Table {
        Title "Mean of the pressure field at the Outlet"
        Description "We want to verify the pressure at the outlet of the cylinder where we imposed the pressure field to be 10. For that we create a new field with the 'Definition_champ' TRUST keyword."
        Description "Syntax of the Definition_champ block for the mean of the 'pression' field on the outlet in the data file:"include_text_file(mean_pression_outlet.txt, Reduction_0D, methode, moyenne, source, interpolation, domaine, localisation, elem, refChamp ,Pb_champ, pression, pression_pa)
        Description "Syntax of the probe line in the data file:"include_text_file(mean_pression_outlet_probe.txt, periode, numero_elem_sur_maitre)

        Description "  "
        Description "The obtained values confirm that Navier-stokes pressure \latex_(\textbf{$P_{NS}$ ='Pression\_Pa'='Pressure'} in [Pa] and \textbf{'Pression' = 'P\_star' = $ \frac{1}{\rho} P_{NS}$} in $[m^2/s^2]$ \latex_)"
        nb_columns 1
        line {
            legend "Mean 'Pression_Pa' field in Pascals"
            file PAR_VEF_P0P1_gx_muscl/mean_pressure.dat
            nb_columns_file 4
            columns ($2)
        }
        line {
            legend "Mean 'Pressure' field in Pascals"
            file PAR_VEF_P0P1_gx_muscl/mean_pressure.dat
            nb_columns_file 4
            columns ($3)
        }
        line {
            legend "Mean 'Pression' field in $[m^2/s^2]$"
            file PAR_VEF_P0P1_gx_muscl/mean_pressure.dat
            nb_columns_file 4
            columns ($1)
        }
        line {
            legend "Mean 'P_Star' field in $[m^2/s^2]$"
            file PAR_VEF_P0P1_gx_muscl/mean_pressure.dat
            nb_columns_file 4
            columns ($4)
        }
    }

################################################################
################################################################

    Table {
        Title "Flow rate"
        nb_columns 3
        label "Theorical volume flow rate" | "TRUST volume flow rate" | "Error on \latex_($Q_v$\latex_) in $%$"
        line {
            legend "Muscl"
            file PAR_VEF_P0P1_gx_muscl/propertiesGeometry.dat
            nb_columns_file 17
            columns ($5) ($16) ($17)
        }
#        line {
#            legend "Amont"
#            file PAR_VEF_P0P1_gx_amont/propertiesGeometry.dat
#            nb_columns_file 17
#            columns ($5) ($16) ($17)
#        }
        line {
            legend "Ef_Stab"
            file PAR_VEF_P0P1_gx_ef_stab/propertiesGeometry.dat
            nb_columns_file 17
            columns ($5) ($16) ($17)
        }
        line {
            legend "Negligeable"
            file PAR_VEF_P0P1_gx_negligeable/propertiesGeometry.dat
            nb_columns_file 17
            columns ($5) ($16) ($17)
        }
    }

################################################################
################################################################

#    visu {
#        Title       "Velocity slice belong Y axis"
#        Width       12cm
#        pseudocolor PAR_VEF_P0P1_gx_muscl/PAR_VEF_P0P1_gx_muscl.lata   dom_dual_magnitude   VITESSE   FACES
#        Operator    slice2D       0 0 0 0 1 0
#    }

################################################################
################################################################

    figure { 
        Title "Velocity profil for a Poiseuille flow at final time step for x=0.05" 
#        Description "\latex_( We impose in inlet: $$u(r)=\frac{K}{4 \mu} \left(r^2-R^2\right)=-\frac{u_{max}}{R^2} \left(r^2-R^2\right)$$ with $u_{max}=u(0)=0.01$, $R=0.1$ and $r=y^2+z^2$. \\ \latex_)"
        Description include_text_file(VITX_probe.txt, vitessex, segment, periode)
#        title_figure "X component of the velocity field below z axis"
        Width 12cm
        include_description_curves 0
        labelX "z (m)"
        labelY "Velocity (m/s)"
        legend below title "Legend"
        curve {
            Fonction -0.01*(x**2-0.1**2)/0.1**2
            legend "Analytic solution"
            style lines
        }
        curve {
            Segment PAR_VEF_P0P1_gx_muscl/PAR_VEF_P0P1_gx_muscl.data VITX
            columns ($1) ($2)
            legend "Muscl vitX probe"
            style linespoints
        }
#        curve {
#            Segment PAR_VEF_P0P1_gx_amont/PAR_VEF_P0P1_gx_amont.data VITX
#            columns ($1) ($2)
#            legend "Amont vitX probe"
#            style linespoints
#        }
        curve {
            Segment PAR_VEF_P0P1_gx_ef_stab/PAR_VEF_P0P1_gx_ef_stab.data VITX
            columns ($1) ($2)
            legend "Ef_Stab vitX probe"
            style linespoints
        }
        curve {
            Segment PAR_VEF_P0P1_gx_negligeable/PAR_VEF_P0P1_gx_negligeable.data VITX
            columns ($1) ($2)
            legend "Negligeable vitX probe"
            style linespoints
        }
    }

################################################################
################################################################

#    visu {
#        Title       "Pressure slice belong Y axis"
#        Width       12cm
#        pseudocolor PAR_VEF_P0P1_gx_muscl/PAR_VEF_P0P1_gx_muscl.lata   dom   PRESSURE_TOT   ELEM
#        Operator    slice2D       0 0 0 0 1 0
#    }

################################################################
################################################################

    figure { 
        Title "Total pressure profil" 
        Description "Here we don't concider the hydrostatic pressure because in this configuration, the gravity pushes the flow."
        Description include_text_file(pression_tot_gx.txt, Predefini, Transformation, methode, formule, expression, localisation, elem, sources_reference, energie_cinetique_elem, sources, RefChamp, Pb_champ, pression_pa, nom_source, pression_hydrostatique, masse_volumique )
        Width 12cm
        include_description_curves 0
        labelX "x (m)"
        labelY "Pressure (Pa)"
        legend below title "Legend"
#        curve {
#            Fonction -4*0.001002*0.01/0.1**2*(x-0.1)+10
#            legend "Analytic solution"
#            style lines
#        }
        curve {
            Segment PAR_VEF_P0P1_gx_muscl/PAR_VEF_P0P1_gx_muscl.data PTOT
            columns ($1) ($2)
            legend "Muscl ptot probe"
            style linespoints
        }
#        curve {
#            Segment PAR_VEF_P0P1_gx_amont/PAR_VEF_P0P1_gx_amont.data PTOT
#            columns ($1) ($2)
#            legend "Amont ptot probe"
#            style linespoints
#        }
        curve {
            Segment PAR_VEF_P0P1_gx_ef_stab/PAR_VEF_P0P1_gx_ef_stab.data PTOT
            columns ($1) ($2)
            legend "Ef_Stab ptot probe"
            style linespoints
        }
        curve {
            Segment PAR_VEF_P0P1_gx_negligeable/PAR_VEF_P0P1_gx_negligeable.data PTOT
            columns ($1) ($2)
            legend "Negligeable ptot probe"
            style linespoints
        }
    }

################################################################
################################################################

    figure { 
        Title "Pressure profil" 
        Width 12cm
        include_description_curves 0
        labelX "x (m)"
        labelY "Pressure (Pa)"
        legend below title "Legend"
        curve {
            Fonction -4*0.001002*0.01/0.1**2*(x-0.1)+10
            legend "Analytic solution"
            style lines
        }
        curve {
            Segment PAR_VEF_P0P1_gx_muscl/PAR_VEF_P0P1_gx_muscl.data P_PA
            columns ($1) ($2)
            legend "Muscl p_pa probe"
            style linespoints
        }
        curve {
            Segment PAR_VEF_P0P1_gx_ef_stab/PAR_VEF_P0P1_gx_ef_stab.data P_PA
            columns ($1) ($2)
            legend "Ef_Stab p_pa probe"
            style linespoints
        }
        curve {
            Segment PAR_VEF_P0P1_gx_negligeable/PAR_VEF_P0P1_gx_negligeable.data P_PA
            columns ($1) ($2)
            legend "Negligeable p_pa probe"
            style linespoints
        }
    }

################################################################
################################################################

    figure { 
        Title "Pressure hydrostatique profil" 
        Width 12cm
        include_description_curves 0
        labelX "x (m)"
        labelY "Pressure (Pa)"
        legend below title "Legend"
        curve {
            Fonction -1000*9.81*x
            legend "Analytic solution"
            style lines
        }
        curve {
            Segment PAR_VEF_P0P1_gx_muscl/PAR_VEF_P0P1_gx_muscl.data PRESSION_HYDRO
            columns ($1) ($2)
            legend "Muscl pression_hydro probe"
            style linespoints
        }
        curve {
            Segment PAR_VEF_P0P1_gx_ef_stab/PAR_VEF_P0P1_gx_ef_stab.data PRESSION_HYDRO
            columns ($1) ($2)
            legend "Ef_Stab pression_hydro probe"
            style linespoints
        }
        curve {
            Segment PAR_VEF_P0P1_gx_negligeable/PAR_VEF_P0P1_gx_negligeable.data PRESSION_HYDRO
            columns ($1) ($2)
            legend "Negligeable pression_hydro probe"
            style linespoints
        }
    }

################################################################
################################################################

    figure { 
        Title "Kinetic energy profil" 
        Width 12cm
        include_description_curves 0
        labelX "x (m)"
        labelY "Pressure (Pa)"
        legend below title "Legend"
        curve {
            Fonction 0.5*1000*0.01*0.01
            legend "Analytic solution"
            style lines
        }
        curve {
            Segment PAR_VEF_P0P1_gx_muscl/PAR_VEF_P0P1_gx_muscl.data EC
            columns ($1) ($2)
            legend "Muscl ec probe"
            style linespoints
        }
        curve {
            Segment PAR_VEF_P0P1_gx_ef_stab/PAR_VEF_P0P1_gx_ef_stab.data EC
            columns ($1) ($2)
            legend "Ef_Stab ec probe"
            style linespoints
        }
        curve {
            Segment PAR_VEF_P0P1_gx_negligeable/PAR_VEF_P0P1_gx_negligeable.data EC
            columns ($1) ($2)
            legend "Negligeable ec probe"
            style linespoints
        }
    }

################################################################
################################################################

    Table {
        Title "Pressure drop on the mean of the pressure at the inlet and outlet"
        nb_columns 3
        label $\Delta$P theoretical | $\Delta$P TRUST | Error on $\Delta$P in $%$ 
        line {
            legend "Muscl"
            file PAR_VEF_P0P1_gx_muscl/propertiesGeometry.dat
            nb_columns_file 17
            columns ($7) ($14) ($15)
        }
#        line {
#            legend "Amont"
#            file PAR_VEF_P0P1_gx_amont/propertiesGeometry.dat
#            nb_columns_file 17
#            columns ($7) ($14) ($15)
#        }
        line {
            legend "Ef_Stab"
            file PAR_VEF_P0P1_gx_ef_stab/propertiesGeometry.dat
            nb_columns_file 17
            columns ($7) ($14) ($15)
        }
#        line {
#            legend "Negligeable"
#            file PAR_VEF_P0P1_gx_negligeable/propertiesGeometry.dat
#            nb_columns_file 17
#            columns ($7) ($14) ($15)
#        }
    }

################################################################
################################################################

    Table {
        Title "Pressure drop between the two symmetrical points of the probe 1"
        nb_columns 3
        label $\Delta$P theoretical | $\Delta$P TRUST | Error on $\Delta$P in $%$ 
        line {
            legend "Muscl"
            file PAR_VEF_P0P1_gx_muscl/propertiesGeometry.dat
            nb_columns_file 17
            columns ($7) ($8) ($9)
        }
#        line {
#            legend "Amont"
#            file PAR_VEF_P0P1_gx_amont/propertiesGeometry.dat
#            nb_columns_file 17
#            columns ($7) ($8) ($9)
#        }
        line {
            legend "Ef_Stab"
            file PAR_VEF_P0P1_gx_ef_stab/propertiesGeometry.dat
            nb_columns_file 17
            columns ($7) ($8) ($9)
        }
#        line {
#            legend "Negligeable"
#            file PAR_VEF_P0P1_gx_negligeable/propertiesGeometry.dat
#            nb_columns_file 17
#            columns ($7) ($8) ($9)
#        }
    }

################################################################
################################################################

    Table {
        Title "Pressure drop between the two symmetrical points of the probe 3"
        nb_columns 3
        label $\Delta$P theoretical | $\Delta$P TRUST | Error on $\Delta$P in $%$ 
        line {
            legend "Muscl"
            file PAR_VEF_P0P1_gx_muscl/propertiesGeometry.dat
            nb_columns_file 17
            columns ($7) ($12) ($13)
        }
#        line {
#            legend "Amont"
#            file PAR_VEF_P0P1_gx_amont/propertiesGeometry.dat
#            nb_columns_file 17
#            columns ($7) ($12) ($13)
#        }
        line {
            legend "Ef_Stab"
            file PAR_VEF_P0P1_gx_ef_stab/propertiesGeometry.dat
            nb_columns_file 17
            columns ($7) ($12) ($13)
        }
#        line {
#            legend "Negligeable"
#            file PAR_VEF_P0P1_gx_negligeable/propertiesGeometry.dat
#            nb_columns_file 17
#            columns ($7) ($12) ($13)
#        }
    }
}


#####################################################################################################################

