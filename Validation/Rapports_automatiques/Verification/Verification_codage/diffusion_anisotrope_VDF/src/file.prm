Parameters {
        Title "Anisotropic diffusion operator for the VDF discretization in TRUST"
        Description "\latex_( \input{\orig/intro} \latex_)"
        VersionTrio_U "1.8.3"
        Author "Elie Saikali and Thomas Galie"
        TestCase TC1 TC1.data
        TestCase TC2/Ar1/M1 TC2.data
        TestCase TC2/Ar1/M2 TC2.data 2
        TestCase TC2/Ar1/M3 TC2.data 4
        TestCase TC2/Ar1/M1 TC2_iso.data
        TestCase TC2/Ar1/M2 TC2_iso.data 2
        TestCase TC2/Ar1/M3 TC2_iso.data 4
      	TestCase TC2/Ar10/M1 TC2.data
      	TestCase TC2/Ar10/M2 TC2.data 2
      	TestCase TC2/Ar10/M3 TC2.data 4
      	TestCase TC2/Ar100/M1 TC2.data
      	TestCase TC2/Ar100/M2 TC2.data 2
      	TestCase TC2/Ar100/M3 TC2.data 4
      	TestCase TC2/Ar1000/M1 TC2.data
      	TestCase TC2/Ar1000/M2 TC2.data 2
      	TestCase TC2/Ar1000/M3 TC2.data 4
}


chapter
{

	Description "\latex_( \input{\orig/test_case1} \latex_)"

        title "Test case 1 : anisotropic and discontinuous \latex_( $\kappa$ \latex_)"

        visu {
                title "The Mesh"
                Width 15cm
                operator no_databaseinfo
                operator_to_all no_legend
                cycles -1
                mesh TC1/TC1.lata DOM
        }


        visu {
                title "Conductivity tensor : component 1"
                Width 15cm
                operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC1/TC1_VOLUME.lata DIFFUSIVITE_THERMIQUE_X_ELEM_DOM
        }


visu {
                title "Conductivity tensor : component 2"
                Width 15cm
                operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC1/TC1_VOLUME.lata DIFFUSIVITE_THERMIQUE_Y_ELEM_DOM
        }

visu {
                title "Temperature at steady state"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC1/TC1_VOLUME.lata TEMPERATURE_ELEM_DOM
        }


visu {
                title "Difference from analytical solution"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC1/TC1.lata ERROR_ELEM_ELEM_DOM
        }


}

# test case 2

chapter
{

        Description "\latex_( \input{\orig/test_case2} \latex_)"

        title "Test case 2 : \latex_( anisotropic and non-uniform $\kappa$\latex_)"

        visu {
                title "The Mesh M1"
                Width 15cm
                operator no_databaseinfo
                operator_to_all no_legend
                cycles -1
                mesh TC2/Ar100/M1/TC2.lata DOM
        }

	 visu {
                title "The Mesh M2"
                Width 15cm
                operator no_databaseinfo
                operator_to_all no_legend
                cycles -1
                mesh TC2/Ar100/M2/TC2.lata DOM
        }

	 visu {
                title "The Mesh M3"
                Width 15cm
                operator no_databaseinfo
                operator_to_all no_legend
                cycles -1
                mesh TC2/Ar100/M3/TC2.lata DOM
        }


}

chapter
{

	title "\latex_(Results of test case 2 with $A_r=1$ \latex_)"
	Description "\latex_(The conductivity components are identical for this case (see distribution in figure 4.1). We note that the conductivity is diagonally distributed in the domain; highest values at the top right corner, and diffuses symmetrically to the facing corner where it takes the smallest value. The obtained temperature distribution at steady state with mesh M1 (physical time about 12.5 s) is shown in figure 4.2 and the difference from the analytical solution is illustrated in figure 4.3. It can be stated that the solution is not far from the exact solution, although the error values are not too small compared to test case 1; here the difference can reach to about $9.10^{-4}$ K. With M2, the resolution is improved and the time required to reach a steady state is reduced (10.3 s of physical time). This can be illustrated in figures 4.4 and 4.5. Moreover, better improvements are recorded with M3: steady state reaches at 7.2 s, and absolute error about $7.610^{-5}$ K at maximum (see figures 4.6 and 4.7). Same results are obtained on all meshes with an isotropic conductivity which confirms the results (figures 4.8 to 4.13).  \latex_)"

        visu {
                title "Conductivity tensor : component 1"
                Width 15cm
                operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1/M1/TC2_VOLUME.lata DIFFUSIVITE_THERMIQUE_X_ELEM_DOM
        }


visu {
                title "Temperature at steady state : M1"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1/M1/TC2_VOLUME.lata TEMPERATURE_ELEM_DOM
        }


visu {
                title "Difference from analytical solution : M1"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1/M1/TC2.lata ERROR_ELEM_ELEM_DOM
        }

visu {
                title "Temperature at steady state : M2"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1/M2/TC2_VOLUME.lata TEMPERATURE_ELEM_DOM
        }


visu {
                title "Difference from analytical solution : M2"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1/M2/TC2.lata ERROR_ELEM_ELEM_DOM
        }

visu {
                title "Temperature at steady state : M3"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1/M3/TC2_VOLUME.lata TEMPERATURE_ELEM_DOM
        }


visu {
                title "Difference from analytical solution : M3"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1/M3/TC2.lata ERROR_ELEM_ELEM_DOM
        }


visu {
                title "Temperature at steady state (Isotropic conductivity) : M1"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1/M1/TC2_iso_VOLUME.lata TEMPERATURE_ELEM_DOM
        }


visu {
                title "Difference from analytical solution (Isotropic) : M1"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1/M1/TC2_iso.lata ERROR_ELEM_ELEM_DOM
        }

visu {
                title "Temperature at steady state (Isotropic conductivity) : M2"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1/M2/TC2_iso_VOLUME.lata TEMPERATURE_ELEM_DOM
        }


visu {
                title "Difference from analytical solution (Isotropic) : M2"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1/M2/TC2_iso.lata ERROR_ELEM_ELEM_DOM
        }

visu {
                title "Temperature at steady state (Isotropic conductivity) : M3"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1/M3/TC2_iso_VOLUME.lata TEMPERATURE_ELEM_DOM
        }


visu {
                title "Difference from analytical solution (Isotropic) : M3"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1/M3/TC2_iso.lata ERROR_ELEM_ELEM_DOM
        }

}


chapter
{

	title "\latex_(Results of test case 2 with $A_r=10$ \latex_)"
	Description "\latex_(Figures 5.1-5.2 depict the distribution of the conductivity diagonal components. We note for mesh M1 that the time required to achieve a steady state is a bit long (physical time of 17 s). This is surely the effect of the increase in the anisotropic ratio. The obtained temperature distribution is shown in figure 5.3 and the difference from the analytical solution is considered in figure 5.4. Again, the difference between the numerical solution and the exact solution takes a maximum value of about $1.10^{-3}$ K near the boundary $\partial \Omega$. The numerical resolution improves and the time required to attain a steady state reduces by refining the mesh. See figures 5.5 and 5.6 for M2, figures 5.7 and 5.8 for M3.\latex_)"

        visu {
                title "Conductivity tensor : component 1"
                Width 15cm
                operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar10/M1/TC2_VOLUME.lata DIFFUSIVITE_THERMIQUE_X_ELEM_DOM
        }


visu {
                title "Conductivity tensor : component 2"
                Width 15cm
                operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar10/M1/TC2_VOLUME.lata DIFFUSIVITE_THERMIQUE_Y_ELEM_DOM
        }

visu {
                title "Temperature at steady state : M1"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar10/M1/TC2_VOLUME.lata TEMPERATURE_ELEM_DOM
        }


visu {
                title "Difference from analytical solution : M1"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar10/M1/TC2.lata ERROR_ELEM_ELEM_DOM
        }
visu {
                title "Temperature at steady state : M2"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar10/M2/TC2_VOLUME.lata TEMPERATURE_ELEM_DOM
        }


visu {
                title "Difference from analytical solution : M2"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar10/M2/TC2.lata ERROR_ELEM_ELEM_DOM
        }

visu {
                title "Temperature at steady state : M3"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar10/M3/TC2_VOLUME.lata TEMPERATURE_ELEM_DOM
        }


visu {
                title "Difference from analytical solution : M3"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar10/M3/TC2.lata ERROR_ELEM_ELEM_DOM
        }

}


chapter
{

	title "\latex_(Results of test case 2 with $A_r=100$ \latex_)"
	Description "\latex_(Figures 6.1-6.2 show the distribution of the $\kappa$ components when the anisotropy ratio is set to 100. With mesh M1, the obtained temperature distribution (at steady state) is shown in figure 6.3 and the difference from the analytical solution in figure 6.4. As expected, the resolution is improved by refining the mesh (figures 6.5 to 6.8). No issues of convergence are noticed here, unlike the VEF case (see the validation file of VEF)! This is a good result! \latex_)"

        visu {
                title "Conductivity tensor : component 1"
                Width 15cm
                operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar100/M1/TC2_VOLUME.lata DIFFUSIVITE_THERMIQUE_X_ELEM_DOM
        }



visu {
                title "Conductivity tensor : component 2"
                Width 15cm
                operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar100/M1/TC2_VOLUME.lata DIFFUSIVITE_THERMIQUE_Y_ELEM_DOM
        }

visu {
                title "Temperature at steady state : M1"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar100/M1/TC2_VOLUME.lata TEMPERATURE_ELEM_DOM
        }


visu {
                title "Difference from analytical solution : M1"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar100/M1/TC2.lata ERROR_ELEM_ELEM_DOM
        }

visu {
                title "Temperature at steady state : M2"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar100/M2/TC2_VOLUME.lata TEMPERATURE_ELEM_DOM
        }


visu {
                title "Difference from analytical solution : M2"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar100/M2/TC2.lata ERROR_ELEM_ELEM_DOM
        }
visu {
                title "Temperature at steady state : M3"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar100/M3/TC2_VOLUME.lata TEMPERATURE_ELEM_DOM
        }


visu {
                title "Difference from analytical solution : M3"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar100/M3/TC2.lata ERROR_ELEM_ELEM_DOM
        }


}


chapter
{

	title "Test case 2 : \latex_( $A_r=1000$ \latex_)"
	Description "\latex_(Same when the anisotropic ratio is increased to $A_r=1000$. The resolution is improved by refining the mesh and no convergence issues are reported. \latex_)"

        visu {
                title "Conductivity tensor : component 1"
                Width 15cm
                operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1000/M1/TC2_VOLUME.lata DIFFUSIVITE_THERMIQUE_X_ELEM_DOM
        }

visu {
                title "Conductivity tensor : component 2"
                Width 15cm
                operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1000/M1/TC2_VOLUME.lata DIFFUSIVITE_THERMIQUE_Y_ELEM_DOM
        }

visu {
                title "Temperature at steady state : M1"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1000/M1/TC2_VOLUME.lata TEMPERATURE_ELEM_DOM
        }


visu {
                title "Difference from analytical solution : M1"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1000/M1/TC2.lata ERROR_ELEM_ELEM_DOM
        }

visu {
                title "Temperature at steady state : M2"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1000/M2/TC2_VOLUME.lata TEMPERATURE_ELEM_DOM
        }


visu {
                title "Difference from analytical solution : M2"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1000/M2/TC2.lata ERROR_ELEM_ELEM_DOM
        }

visu {
                title "Temperature at steady state : M3"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1000/M3/TC2_VOLUME.lata TEMPERATURE_ELEM_DOM
        }


visu {
                title "Difference from analytical solution : M3"
                Width 15cm
                #operator no_databaseinfo
                #operator_to_all no_legend
                cycles -1
                pseudocolor TC2/Ar1000/M3/TC2.lata ERROR_ELEM_ELEM_DOM
        }

}

Chapter
{
  Table
    {
        Title "Max and average error"
        Description "The table below summarizes the maximum and average error values obtained in all cases at the steady state. The influence of the mesh refinement (for test case 2) is evident."

        nb_columns 2
        label  Max value | Average value

        line {
                legend "Test Case 1"
                file TC1/Error_values.txt
                nb_columns_file 2
                columns $1 $2
                last_line
        }
        line {
                legend "Test Case 2, Ar=1 : M1"
                file TC2/Ar1/M1/Error_values.txt
                nb_columns_file 2
                columns $1 $2
                last_line
        }
        line {
                legend "Test Case 2, Ar=10 : M1"
                file TC2/Ar10/M1/Error_values.txt
                nb_columns_file 2
                columns $1 $2
                last_line
        }
        line {
                legend "Test Case 2, Ar=100 : M1"
                file TC2/Ar100/M1/Error_values.txt
                nb_columns_file 2
                columns $1 $2
                last_line
        }
        line {
                legend "Test Case 2, Ar=1000 : M1"
                file TC2/Ar1000/M1/Error_values.txt
                nb_columns_file 2
                columns $1 $2
                last_line
        }

        line {
                legend "Test Case 2, Ar=1 : M2"
                file TC2/Ar1/M2/Error_values.txt
                nb_columns_file 2
                columns $1 $2
                last_line
        }
        line {
                legend "Test Case 2, Ar=10 : M2"
                file TC2/Ar10/M2/Error_values.txt
                nb_columns_file 2
                columns $1 $2
                last_line
        }
        line {
                legend "Test Case 2, Ar=100 : M2"
                file TC2/Ar100/M2/Error_values.txt
                nb_columns_file 2
                columns $1 $2
                last_line
        }
        line {
                legend "Test Case 2, Ar=1000 : M2"
                file TC2/Ar1000/M2/Error_values.txt
                nb_columns_file 2
                columns $1 $2
                last_line
        }
        line {
                legend "Test Case 2, Ar=1 : M3"
                file TC2/Ar1/M3/Error_values.txt
                nb_columns_file 2
                columns $1 $2
                last_line
        }
        line {
                legend "Test Case 2, Ar=10 : M3"
                file TC2/Ar10/M3/Error_values.txt
                nb_columns_file 2
                columns $1 $2
                last_line
        }
        line {
                legend "Test Case 2, Ar=100 : M3"
                file TC2/Ar100/M3/Error_values.txt
                nb_columns_file 2
                columns $1 $2
                last_line
        }
        line {
                legend "Test Case 2, Ar=1000 : M3"
                file TC2/Ar1000/M3/Error_values.txt
                nb_columns_file 2
                columns $1 $2
                last_line
        }

    }
}

Chapter {
        Title "Concluding remarks"
        Description "\latex_(In this report, a validation study concerning the implementation of a VDF anisotropic diffusion operator for in the TRUST platform is documented. Different simulations are performed and numerical results at steady-state are compared to analytical solutions for validations. Two test cases are investigated, either with an anisotropic discontinuous conductivity tensor or a non-uniform one. The mesh sensitivity is highlighted where numerical results show that TRUST can handle high anisotropic ratios if a fine mesh is used. We advise the user to perform a grid convergence study before starting the physical interpretation of the numerical data. Till present, we have only one limitation for the VDF anisotropic operator: \textbf{the conductivity tensor should be diagonal}.  \latex_)"
}

Chapter {
        Title "Computer performance"
        tableau_performance {
        }
}
