Parameters {
	Title "Ecoulement laminaire dans un coude"
	Description "On calcule l'écoulement bidimensionnel dans un coude.  L'écoulement est laminaire et on néglige la convection.  Les parois du domaine sont fixes et une condition d'adhérence y est imposée.  Une solution analytique à ce problème existe et on compare les résultats calculés par GENEPI à cette solution analytique."
	Author "D. Jamet"
	TestCase "." "eclt_coude.data"
	IncludeData 1
}

Chapter {
	Title "Champs de pression et de vitesse"
	Description "Dans cette partie, on compare le champ de pression calculé par GENEPI et le champ de pression analytique."


	visu {
                Title "Champs de pression et de vitesse calculés"
                description "Le champ de pression calculé par GENEPI est tracé et le champ de pression analytique est donné par des iso-valeurs."
                mesh ./eclt_coude.lata dom 
                pseudocolor ./eclt_coude.lata dom PRESSION_PA ELEM
                instruction_visit DefineScalarExpression("P_ANALYTIQUE_ELEM_dom","(-0.225E1*acos(coord(dom)[0]/sqrt(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1]))/ln(2.0)+0.1125E1*0.3141592653589793E1/ln(2.0))")
		vector  ./eclt_coude.lata dom VITESSE SOM
        }


	visu {
                Title "Champs de pression et de vitesse analytiques"
                description "Le champ de pression analytique est tracé et le champ de pression calculé par GENEPI est donné par des iso-valeurs."
                mesh ./eclt_coude.lata dom 
                instruction_visit DefineScalarExpression("P_ANALYTIQUE_ELEM_dom","(-0.225E1*acos(coord(dom)[0]/sqrt(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1]))/ln(2.0)+0.1125E1*0.3141592653589793E1/ln(2.0))")
		instruction_visit DefineVectorExpression("V_ANALYTIQUE_SOM_dom","{(-(8.0*ln(2.0)*coord(dom)[0]*coord(dom)[0]+8.0*ln(2.0)*coord(dom)[1]*coord(dom)[1]-8.0*ln(2.0)-3.0*ln(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1])*coord(dom)[0]*coord(dom)[0]-3.0*ln(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1])*coord(dom)[1]*coord(dom)[1])*sqrt(coord(dom)[1]*coord(dom)[1]/(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1]))/sqrt(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1])/ln(2.0)/8.0),((8.0*ln(2.0)*coord(dom)[0]*coord(dom)[0]+8.0*ln(2.0)*coord(dom)[1]*coord(dom)[1]-8.0*ln(2.0)-3.0*ln(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1])*coord(dom)[0]*coord(dom)[0]-3.0*ln(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1])*coord(dom)[1]*coord(dom)[1])*coord(dom)[0]/(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1])/ln(2.0)/8.0)}")
                pseudocolor ./eclt_coude.lata dom P_ANALYTIQUE ELEM
		vector  ./eclt_coude.lata dom V_ANALYTIQUE SOM
        }

	visu {
                Title "Erreurs sur les champs de pression et de vitesse"
                description "On trace l'erreur entre le champ de pression calculé par GENEPI et le champ de pression analytique.  Sont superposés le champ de l'erreur et les iso-valeurs de l'erreur (pour plus de clarté, le maillage n'est pas tracé)."
                instruction_visit DefineScalarExpression("ERREUR_P_ELEM_dom","PRESSION_PA_ELEM_dom-(-0.225E1*acos(coord(dom)[0]/sqrt(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1]))/ln(2.0)+0.1125E1*0.3141592653589793E1/ln(2.0))")
                pseudocolor ./eclt_coude.lata dom ERREUR_P ELEM
		instruction_visit DefineVectorExpression("V_ANALYTIQUE_SOM_dom","{(-(8.0*ln(2.0)*coord(dom)[0]*coord(dom)[0]+8.0*ln(2.0)*coord(dom)[1]*coord(dom)[1]-8.0*ln(2.0)-3.0*ln(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1])*coord(dom)[0]*coord(dom)[0]-3.0*ln(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1])*coord(dom)[1]*coord(dom)[1])*sqrt(coord(dom)[1]*coord(dom)[1]/(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1]))/sqrt(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1])/ln(2.0)/8.0),((8.0*ln(2.0)*coord(dom)[0]*coord(dom)[0]+8.0*ln(2.0)*coord(dom)[1]*coord(dom)[1]-8.0*ln(2.0)-3.0*ln(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1])*coord(dom)[0]*coord(dom)[0]-3.0*ln(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1])*coord(dom)[1]*coord(dom)[1])*coord(dom)[0]/(coord(dom)[0]*coord(dom)[0]+coord(dom)[1]*coord(dom)[1])/ln(2.0)/8.0)}")
		instruction_visit DefineVectorExpression("ERREUR_V_SOM_dom","VITESSE_SOM_dom-V_ANALYTIQUE_SOM_dom")
		vector  ./eclt_coude.lata dom ERREUR_V SOM
        }
}

Chapter {
	Title "Perte de pression dans la conduite"
	Description "La pression étant connue analytiquement, on peut comparer les pertes de pression analytique et calculée par GENEPI.  Ces valeurs sont donnés dans le tableau suivant ainsi que l'erreur correspondante."


	Table {
		Title "Comparaison théorie/numérique"
		nb_columns 1
		label  Perte de pression
		line {
			legend Analytique
			alias ref
			Version "1.5.3-beta_build_180907"
			values 5.099
		}
		line {
			legend Calcul
			alias calcul
			origin "Trio_U"
			Version "1.5.3-beta_build_180907"
			nb_columns_file 8
			file ./eclt_coude_fin.out
			columns (($8)-($7))
		}
		line {
			legend ecart_relatif
			alias erreur
			origin "Trio_U"
			Version "1.5.3-beta_build_180907"
			difference ecart_relatif calcul ref
			display_line 0	
		}
		line {
	        	legend "erreur en %"
			alias err_relative
		        difference formule erreur ref int(v1*10000)/100.
	        }
	}
}

